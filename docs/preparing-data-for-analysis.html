<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Applied Statistics II</title>
  <meta name="description" content="Course notes for MATH 456 at CSU Chico">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Applied Statistics II" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course notes for MATH 456 at CSU Chico" />
  <meta name="github-repo" content="norcalbiostat/MATH456_notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Applied Statistics II" />
  
  <meta name="twitter:description" content="Course notes for MATH 456 at CSU Chico" />
  

<meta name="author" content="Robin A. Donatello and Edward A. Roualdes">


<meta name="date" content="2018-01-09">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html">
<link rel="next" href="multiple-linear-regression.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Statistics II course notes</a></li>

<li class="divider"></li>
<li class="part"><span><b>Regression Model Building</b></span></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="preparing-data-for-analysis.html"><a href="preparing-data-for-analysis.html"><i class="fa fa-check"></i><b>1</b> Preparing Data for Analysis</a><ul>
<li class="chapter" data-level="1.1" data-path="preparing-data-for-analysis.html"><a href="preparing-data-for-analysis.html#a-reproducible-workflow"><i class="fa fa-check"></i><b>1.1</b> A Reproducible Workflow</a></li>
<li class="chapter" data-level="1.2" data-path="preparing-data-for-analysis.html"><a href="preparing-data-for-analysis.html#identifying-variable-types"><i class="fa fa-check"></i><b>1.2</b> Identifying Variable Types</a></li>
<li class="chapter" data-level="1.3" data-path="preparing-data-for-analysis.html"><a href="preparing-data-for-analysis.html#data-editing-and-recoding"><i class="fa fa-check"></i><b>1.3</b> Data Editing and Recoding</a></li>
<li class="chapter" data-level="1.4" data-path="preparing-data-for-analysis.html"><a href="preparing-data-for-analysis.html#outliers"><i class="fa fa-check"></i><b>1.4</b> Outliers</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html"><i class="fa fa-check"></i><b>2</b> Multiple Linear Regression</a></li>
<li class="chapter" data-level="3" data-path="logistic-regression.html"><a href="logistic-regression.html"><i class="fa fa-check"></i><b>3</b> Logistic Regression</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Statistics II</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="preparing-data-for-analysis" class="section level1">
<h1><span class="header-section-number">Chapter 1</span> Preparing Data for Analysis</h1>
<p>Just a recap</p>
<div id="a-reproducible-workflow" class="section level2">
<h2><span class="header-section-number">1.1</span> A Reproducible Workflow</h2>
<div class="figure">
<img src="images/Afifi_Fig3_1.png" alt="PrepareData" />
<p class="caption">PrepareData</p>
</div>
<ul>
<li>You are your own collaborator 6 months from now. Make sure you will be able to understand what you were doing.</li>
<li>Investing the time to do things clearly and in a reproducible manner will make your future self happy.</li>
<li>Comment your code with explanations and instructions.
<ul>
<li>How did you get from point A to B?</li>
<li>Why did you recode this variable in this manner?</li>
</ul></li>
<li>This is reason #1 we use the Markdown language through R.</li>
</ul>
<div class="figure">
<img src="images/pipeline.PNG" alt="Repro" />
<p class="caption">Repro</p>
</div>
<p>Figure Credits: <a href="http://www.biostat.jhsph.edu/~rpeng/">Roger Peng</a></p>
</div>
<div id="identifying-variable-types" class="section level2">
<h2><span class="header-section-number">1.2</span> Identifying Variable Types</h2>
<p>This section uses the <code>depression</code> data set from Afifi et.al.</p>
<p>Consider a variable that measures marital status. What data type does R see this variable as?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(depress<span class="op">$</span>MARITAL)</code></pre></div>
<pre><code>## 
##   1   2   3   4   5 
##  73 127  43  13  38</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(depress<span class="op">$</span>MARITAL)</code></pre></div>
<pre><code>##  int [1:294] 5 3 2 3 4 2 2 1 2 2 ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(depress<span class="op">$</span>MARITAL)</code></pre></div>
<pre><code>## [1] &quot;integer&quot;</code></pre>
<p>When variables have numerical levels it is necessary to ensure that R knows it is a factor variable.</p>
<p>The following code uses the <code>factor()</code> function to take the marital status variable and convert it into a factor variable with specified labels that match the codebook.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">depress<span class="op">$</span>MARITAL &lt;-<span class="st"> </span><span class="kw">factor</span>(depress<span class="op">$</span>MARITAL, 
                          <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Never Married&quot;</span>, <span class="st">&quot;Married&quot;</span>, <span class="st">&quot;Divorced&quot;</span>, <span class="st">&quot;Separated&quot;</span>, <span class="st">&quot;Widowed&quot;</span>))</code></pre></div>
<p>It is important to confirm the recode worked. If it did not you will have to re-read in the raw data set again since the variable <code>SEX</code> was replaced.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(depress<span class="op">$</span>MARITAL)</code></pre></div>
<pre><code>## 
## Never Married       Married      Divorced     Separated       Widowed 
##            73           127            43            13            38</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(depress<span class="op">$</span>MARITAL)</code></pre></div>
<pre><code>## [1] &quot;factor&quot;</code></pre>
<ul>
<li>Create a boxplot of income across marital status category.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(<span class="dt">y=</span>INCOME, <span class="dt">x=</span>MARITAL, <span class="dt">data=</span>depress, <span class="dt">geom=</span><span class="st">&quot;boxplot&quot;</span>)</code></pre></div>
<p><img src="01-Preparing-Data-for-Analysis_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Boxplots are nice because they clearly show the range where 50% of the data lie and any potential outliers. Boxplots can also indicate skewness, but sometimes it is helpful to visualize the location of the mean as well as the median. <code>ggplot2</code> has a nice <code>stat_summary</code> layer that will calculate and add the means to the current plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">qplot</span>(<span class="dt">y=</span>INCOME, <span class="dt">x=</span>MARITAL, <span class="dt">data=</span>depress, <span class="dt">geom=</span><span class="st">&quot;boxplot&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">   </span><span class="kw">stat_summary</span>(<span class="dt">fun.y=</span>mean, <span class="dt">colour=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>, <span class="dt">geom=</span><span class="st">&quot;point&quot;</span>)</code></pre></div>
<p><img src="01-Preparing-Data-for-Analysis_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="data-editing-and-recoding" class="section level2">
<h2><span class="header-section-number">1.3</span> Data Editing and Recoding</h2>
<p>For unbiased and accurate results of a statistical analysis, sufficient data has to be present. Often times once you start slicing and dicing the data to only look at certain groups, or if you are interested in the behavior of certain variables across levels of another variable, sometimes you start to run into small sample size problems. For example, consider marital status again:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(depress<span class="op">$</span>MARITAL)</code></pre></div>
<pre><code>## 
## Never Married       Married      Divorced     Separated       Widowed 
##            73           127            43            13            38</code></pre>
<p>There are only 13 people who report being separated. This could potentially be too small of a group size for valid statistical analysis.</p>
<p>One way to deal with insufficient data within a certain category is to collapse categories. The following code uses the <code>recode()</code> function from the <code>car</code> package to create a new variable that I am calling <code>MARITAL2</code> that combines the <code>Divorced</code> and <code>Separated</code> levels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(car)</code></pre></div>
<pre><code>## 
## Attaching package: &#39;car&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     recode</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">depress<span class="op">$</span>MARITAL2 &lt;-<span class="st"> </span><span class="kw">recode</span>(depress<span class="op">$</span>MARITAL, <span class="st">&quot;&#39;Divorced&#39; = &#39;Sep/Div&#39;; &#39;Separated&#39; = &#39;Sep/Div&#39;&quot;</span>)</code></pre></div>
<p>Always confirm your recodes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(depress<span class="op">$</span>MARITAL, depress<span class="op">$</span>MARITAL2, <span class="dt">useNA=</span><span class="st">&quot;always&quot;</span>)</code></pre></div>
<pre><code>##                
##                 Married Never Married Sep/Div Widowed &lt;NA&gt;
##   Never Married       0            73       0       0    0
##   Married           127             0       0       0    0
##   Divorced            0             0      43       0    0
##   Separated           0             0      13       0    0
##   Widowed             0             0       0      38    0
##   &lt;NA&gt;                0             0       0       0    0</code></pre>
<p>This confirms that records where <code>MARITAL</code> (rows) is <code>Divorced</code> or <code>Separated</code> have the value of <code>Sep/Div</code> for <code>MARITAL2</code> (columns).</p>
<p>Now let’s examine the relationship between income against marital status by creating a boxplot. This is a situation where <em>jittering</em> or <em>dodging</em> the points is helpful to avoid overplotting of points. Note that the full <code>ggplot</code> code had to be used here, not the simpler <code>qplot</code> methods. Furthermore, the <code>grid.arrange</code> function from the <code>gridExtra</code> package is used to display these plots side by side.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(gridExtra)</code></pre></div>
<pre><code>## 
## Attaching package: &#39;gridExtra&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     combine</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="kw">qplot</span>(<span class="dt">x=</span>MARITAL2, <span class="dt">y=</span>INCOME, <span class="dt">data=</span>depress, <span class="dt">col=</span>MARITAL2, <span class="dt">geom=</span><span class="st">&quot;point&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Without jittering&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">           </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)
b &lt;-<span class="st"> </span><span class="kw">ggplot</span>(depress, <span class="kw">aes</span>(<span class="dt">x=</span>INCOME, <span class="dt">y=</span>MARITAL2, <span class="dt">color=</span>MARITAL2), <span class="dt">main=</span><span class="st">&quot;With jittering&quot;</span>) <span class="op">+</span>
<span class="st">            </span><span class="kw">geom_point</span>(<span class="dt">position=</span><span class="kw">position_jitter</span>()) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)
<span class="kw">grid.arrange</span>(a, b, <span class="dt">ncol=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="01-Preparing-Data-for-Analysis_files/figure-html/unnamed-chunk-10-1.png" width="960" /></p>
<ul>
<li><p>What do you think <code>coord_flip()</code> does? Look at the difference in the X and Y values between plot a and plot b.</p></li>
<li><p>What do you think <code>theme(legend.position=&quot;none&quot;)</code> does?</p></li>
</ul>
<p><em>Hint:</em> Try removing them and see what happens.</p>
<ul>
<li>What can you say about the relationship between Income and marital status?</li>
</ul>
</div>
<div id="outliers" class="section level2">
<h2><span class="header-section-number">1.4</span> Outliers</h2>
<p>Let’s look at the age variable in the depression data set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
<span class="kw">boxplot</span>(depress<span class="op">$</span>AGE)
<span class="kw">hist</span>(depress<span class="op">$</span>AGE)</code></pre></div>
<p><img src="01-Preparing-Data-for-Analysis_files/figure-html/unnamed-chunk-11-1.png" width="960" /></p>
<p>Just looking at the data graphically raises no red flags. The boxplot shows no outlying values and the histogram does not look wildly skewed. This is where knowledge about the data set is essential. The codebook does not provide a valid range for the data, but the description of the data starting on page 3 in the textbook clarifies that this data set is on adults. In the research world, this specifies 18 years or older.</p>
<p>Now look back at the graphics. See anything odd? It appears as if the data go pretty far below 20, possibly below 18. Let’s check the numerical summary to get more details.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(depress<span class="op">$</span>AGE)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    9.00   28.00   42.50   44.38   59.00   89.00</code></pre>
<p>The minimum value is a 9, which is outside the range of valid values for this variable. This is where you, as a statistician, data analyst or researcher goes back to the PI and asks for advice. Should this data be set to missing, or edited in a way that changes this data point into a valid piece of data.</p>
<p>As an example of a common data entry error, and for demonstration purposes, I went in and changed a 19 to a 9. So the correct thing to do here is to change that 9, back to a 19. This is a very good use of the <code>ifelse()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">depress<span class="op">$</span>AGE &lt;-<span class="st"> </span><span class="kw">ifelse</span>(depress<span class="op">$</span>AGE<span class="op">==</span><span class="dv">9</span>, <span class="dv">19</span>, depress<span class="op">$</span>AGE)</code></pre></div>
<p>The logical statement is <code>depress$AGE==9</code>. Wherever this is true, replace the value of <code>depress$AGE</code> with 19, wherever this is false then keep the value of <code>depress$AGE</code> unchanged (by “replacing” the new value with the same old value).</p>
<p>Alternatively, you can change that one value using bracket notation. Here you are specifying that you only want the rows where <code>AGE==9</code>, and directly assign a value of 19 to those rows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">depress<span class="op">$</span>AGE[depress<span class="op">$</span>AGE<span class="op">==</span><span class="dv">9</span>] &lt;-<span class="st"> </span><span class="dv">19</span></code></pre></div>
<p>Confirm the recode.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(depress<span class="op">$</span>AGE)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   18.00   28.00   42.50   44.41   59.00   89.00</code></pre>
<p>Looks like it worked.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multiple-linear-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
