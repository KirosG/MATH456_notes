<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Applied Statistics II</title>
  <meta name="description" content="Course notes for MATH 456 at CSU Chico">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Applied Statistics II" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course notes for MATH 456 at CSU Chico" />
  <meta name="github-repo" content="norcalbiostat/MATH456_notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Applied Statistics II" />
  
  <meta name="twitter:description" content="Course notes for MATH 456 at CSU Chico" />
  

<meta name="author" content="Robin A. Donatello and Edward A. Roualdes">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="model-building.html">
<link rel="next" href="stratification.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Statistics II course notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="data-prep.html"><a href="data-prep.html"><i class="fa fa-check"></i><b>1</b> Preparing Data for Analysis</a><ul>
<li class="chapter" data-level="1.1" data-path="reproducible-workflows.html"><a href="reproducible-workflows.html"><i class="fa fa-check"></i><b>1.1</b> Reproducible Workflows</a></li>
<li class="chapter" data-level="1.2" data-path="identifying-variable-types.html"><a href="identifying-variable-types.html"><i class="fa fa-check"></i><b>1.2</b> Identifying Variable Types</a></li>
<li class="chapter" data-level="1.3" data-path="data-editing-and-recoding.html"><a href="data-editing-and-recoding.html"><i class="fa fa-check"></i><b>1.3</b> Data Editing and Recoding</a></li>
<li class="chapter" data-level="1.4" data-path="outliers.html"><a href="outliers.html"><i class="fa fa-check"></i><b>1.4</b> Outliers</a></li>
<li class="chapter" data-level="1.5" data-path="data-transformations.html"><a href="data-transformations.html"><i class="fa fa-check"></i><b>1.5</b> Data Transformations</a></li>
<li class="chapter" data-level="1.6" data-path="selecting-appropriate-analysis.html"><a href="selecting-appropriate-analysis.html"><i class="fa fa-check"></i><b>1.6</b> Selecting Appropriate Analysis</a></li>
<li class="chapter" data-level="1.7" data-path="wide-vs-long-data.html"><a href="wide-vs-long-data.html"><i class="fa fa-check"></i><b>1.7</b> Wide vs. Long data</a></li>
</ul></li>
<li class="part"><span><b>I Regression Modeling</b></span></li>
<li class="chapter" data-level="2" data-path="reg-intro.html"><a href="reg-intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html"><i class="fa fa-check"></i><b>3</b> Simple Linear Regression</a><ul>
<li class="chapter" data-level="3.1" data-path="mathmatical-model.html"><a href="mathmatical-model.html"><i class="fa fa-check"></i><b>3.1</b> Mathmatical Model</a></li>
<li class="chapter" data-level="3.2" data-path="parameter-estimates.html"><a href="parameter-estimates.html"><i class="fa fa-check"></i><b>3.2</b> Parameter Estimates</a></li>
<li class="chapter" data-level="3.3" data-path="interval-estimation.html"><a href="interval-estimation.html"><i class="fa fa-check"></i><b>3.3</b> Interval estimation</a></li>
<li class="chapter" data-level="3.4" data-path="corelation-coefficient.html"><a href="corelation-coefficient.html"><i class="fa fa-check"></i><b>3.4</b> Corelation Coefficient</a></li>
<li class="chapter" data-level="3.5" data-path="assumptions.html"><a href="assumptions.html"><i class="fa fa-check"></i><b>3.5</b> Assumptions</a></li>
<li class="chapter" data-level="3.6" data-path="example.html"><a href="example.html"><i class="fa fa-check"></i><b>3.6</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html"><i class="fa fa-check"></i><b>4</b> Multiple Linear Regression</a><ul>
<li class="chapter" data-level="4.1" data-path="types-of-x-variables.html"><a href="types-of-x-variables.html"><i class="fa fa-check"></i><b>4.1</b> Types of X variables</a></li>
<li class="chapter" data-level="4.2" data-path="mathematical-model.html"><a href="mathematical-model.html"><i class="fa fa-check"></i><b>4.2</b> Mathematical Model</a></li>
<li class="chapter" data-level="4.3" data-path="parameter-estimation.html"><a href="parameter-estimation.html"><i class="fa fa-check"></i><b>4.3</b> Parameter Estimation</a></li>
<li class="chapter" data-level="4.4" data-path="example-1.html"><a href="example-1.html"><i class="fa fa-check"></i><b>4.4</b> Example</a></li>
<li class="chapter" data-level="4.5" data-path="model-diagnostics.html"><a href="model-diagnostics.html"><i class="fa fa-check"></i><b>4.5</b> Model Diagnostics</a></li>
<li class="chapter" data-level="4.6" data-path="multicollinearity.html"><a href="multicollinearity.html"><i class="fa fa-check"></i><b>4.6</b> Multicollinearity</a></li>
<li class="chapter" data-level="4.7" data-path="what-to-watch-out-for.html"><a href="what-to-watch-out-for.html"><i class="fa fa-check"></i><b>4.7</b> What to watch out for</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="model-building.html"><a href="model-building.html"><i class="fa fa-check"></i><b>5</b> Model Building</a><ul>
<li class="chapter" data-level="5.1" data-path="categorical-predictors.html"><a href="categorical-predictors.html"><i class="fa fa-check"></i><b>5.1</b> Categorical Predictors</a><ul>
<li class="chapter" data-level="5.1.1" data-path="categorical-predictors.html"><a href="categorical-predictors.html#factor-variable-coding"><i class="fa fa-check"></i><b>5.1.1</b> Factor variable coding</a></li>
<li class="chapter" data-level="5.1.2" data-path="categorical-predictors.html"><a href="categorical-predictors.html#wald-test"><i class="fa fa-check"></i><b>5.1.2</b> Wald test</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="stratification.html"><a href="stratification.html"><i class="fa fa-check"></i><b>5.2</b> Stratification</a></li>
<li class="chapter" data-level="5.3" data-path="moderation.html"><a href="moderation.html"><i class="fa fa-check"></i><b>5.3</b> Moderation</a><ul>
<li class="chapter" data-level="5.3.1" data-path="moderation.html"><a href="moderation.html#example-1-sepal-vs-petal-length"><i class="fa fa-check"></i><b>5.3.1</b> Example 1: Sepal vs Petal Length</a></li>
<li class="chapter" data-level="5.3.2" data-path="moderation.html"><a href="moderation.html#example-2-simpsons-paradox"><i class="fa fa-check"></i><b>5.3.2</b> Example 2: Simpson’s Paradox</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="interactions.html"><a href="interactions.html"><i class="fa fa-check"></i><b>5.4</b> Interactions</a><ul>
<li class="chapter" data-level="5.4.1" data-path="interactions.html"><a href="interactions.html#example-2"><i class="fa fa-check"></i><b>5.4.1</b> Example</a></li>
<li class="chapter" data-level="5.4.2" data-path="interactions.html"><a href="interactions.html#example-3"><i class="fa fa-check"></i><b>5.4.2</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="confounding.html"><a href="confounding.html"><i class="fa fa-check"></i><b>5.5</b> Confounding</a></li>
<li class="chapter" data-level="5.6" data-path="variable-selection-process.html"><a href="variable-selection-process.html"><i class="fa fa-check"></i><b>5.6</b> Variable Selection Process</a><ul>
<li class="chapter" data-level="5.6.1" data-path="variable-selection-process.html"><a href="variable-selection-process.html#automated-selection-procedures"><i class="fa fa-check"></i><b>5.6.1</b> Automated selection procedures</a></li>
<li class="chapter" data-level="5.6.2" data-path="variable-selection-process.html"><a href="variable-selection-process.html#the-lesser-of-three-evils-best-subsets-pma5-section-8.7"><i class="fa fa-check"></i><b>5.6.2</b> The lesser of three evils: Best Subsets (PMA5 Section 8.7)</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="comparing-between-models.html"><a href="comparing-between-models.html"><i class="fa fa-check"></i><b>5.7</b> Comparing between models</a></li>
<li class="chapter" data-level="5.8" data-path="what-to-watch-out-for-1.html"><a href="what-to-watch-out-for-1.html"><i class="fa fa-check"></i><b>5.8</b> What to watch out for</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>6</b> Generalized Linear Models</a><ul>
<li class="chapter" data-level="6.1" data-path="fitting-glms-in-r.html"><a href="fitting-glms-in-r.html"><i class="fa fa-check"></i><b>6.1</b> Fitting GLMs in R</a></li>
<li class="chapter" data-level="6.2" data-path="binary-data.html"><a href="binary-data.html"><i class="fa fa-check"></i><b>6.2</b> Binary Data</a><ul>
<li class="chapter" data-level="6.2.1" data-path="binary-data.html"><a href="binary-data.html#example-the-effect-of-gender-on-depression"><i class="fa fa-check"></i><b>6.2.1</b> Example: The effect of gender on Depression</a></li>
<li class="chapter" data-level="6.2.2" data-path="binary-data.html"><a href="binary-data.html#multiple-logistic-regression"><i class="fa fa-check"></i><b>6.2.2</b> Multiple Logistic Regression</a></li>
<li class="chapter" data-level="6.2.3" data-path="binary-data.html"><a href="binary-data.html#interpretation"><i class="fa fa-check"></i><b>6.2.3</b> Interpretation</a></li>
<li class="chapter" data-level="6.2.4" data-path="binary-data.html"><a href="binary-data.html#goodness-of-fit"><i class="fa fa-check"></i><b>6.2.4</b> Goodness of Fit</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="classification-of-binary-outcomes.html"><a href="classification-of-binary-outcomes.html"><i class="fa fa-check"></i><b>6.3</b> Classification of Binary outcomes</a><ul>
<li class="chapter" data-level="6.3.1" data-path="classification-of-binary-outcomes.html"><a href="classification-of-binary-outcomes.html#calculating-predictions"><i class="fa fa-check"></i><b>6.3.1</b> Calculating predictions</a></li>
<li class="chapter" data-level="6.3.2" data-path="classification-of-binary-outcomes.html"><a href="classification-of-binary-outcomes.html#model-performance"><i class="fa fa-check"></i><b>6.3.2</b> Model Performance</a></li>
<li class="chapter" data-level="6.3.3" data-path="classification-of-binary-outcomes.html"><a href="classification-of-binary-outcomes.html#roc-curves"><i class="fa fa-check"></i><b>6.3.3</b> ROC Curves</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="categorical-data.html"><a href="categorical-data.html"><i class="fa fa-check"></i><b>6.4</b> Categorical Data</a></li>
<li class="chapter" data-level="6.5" data-path="count-data.html"><a href="count-data.html"><i class="fa fa-check"></i><b>6.5</b> Count Data</a></li>
</ul></li>
<li class="part"><span><b>II Multivariate Analysis</b></span></li>
<li class="chapter" data-level="7" data-path="mv-intro.html"><a href="mv-intro.html"><i class="fa fa-check"></i><b>7</b> Introduction</a></li>
<li class="chapter" data-level="8" data-path="pca.html"><a href="pca.html"><i class="fa fa-check"></i><b>8</b> Principal Component Analysis</a><ul>
<li class="chapter" data-level="8.1" data-path="basic-idea.html"><a href="basic-idea.html"><i class="fa fa-check"></i><b>8.1</b> Basic Idea</a></li>
<li class="chapter" data-level="8.2" data-path="more-generally.html"><a href="more-generally.html"><i class="fa fa-check"></i><b>8.2</b> More Generally</a></li>
<li class="chapter" data-level="8.3" data-path="calculating-c.html"><a href="calculating-c.html"><i class="fa fa-check"></i><b>8.3</b> Calculating C</a></li>
<li class="chapter" data-level="8.4" data-path="using-the-correlation-matrix.html"><a href="using-the-correlation-matrix.html"><i class="fa fa-check"></i><b>8.4</b> Using the correlation matrix</a></li>
<li class="chapter" data-level="8.5" data-path="data-reduction.html"><a href="data-reduction.html"><i class="fa fa-check"></i><b>8.5</b> Data Reduction</a></li>
<li class="chapter" data-level="8.6" data-path="example-analysis-of-depression.html"><a href="example-analysis-of-depression.html"><i class="fa fa-check"></i><b>8.6</b> Example Analysis of depression</a></li>
<li class="chapter" data-level="8.7" data-path="use-in-multiple-regression.html"><a href="use-in-multiple-regression.html"><i class="fa fa-check"></i><b>8.7</b> Use in Multiple Regression</a></li>
<li class="chapter" data-level="8.8" data-path="things-to-watch-out-for.html"><a href="things-to-watch-out-for.html"><i class="fa fa-check"></i><b>8.8</b> Things to watch out for</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="fa.html"><a href="fa.html"><i class="fa fa-check"></i><b>9</b> Factor Analysis</a><ul>
<li class="chapter" data-level="9.1" data-path="stuff.html"><a href="stuff.html"><i class="fa fa-check"></i><b>9.1</b> stuff</a></li>
</ul></li>
<li class="part"><span><b>III Multi-level Analysis</b></span></li>
<li class="chapter" data-level="10" data-path="introduction-hlm-intro.html"><a href="introduction-hlm-intro.html"><i class="fa fa-check"></i><b>10</b> Introduction {# hlm-intro}</a></li>
<li class="chapter" data-level="11" data-path="RI.html"><a href="RI.html"><i class="fa fa-check"></i><b>11</b> Random Intercept Models</a></li>
<li class="chapter" data-level="12" data-path="longitudinal.html"><a href="longitudinal.html"><i class="fa fa-check"></i><b>12</b> Longitudinal Data</a></li>
<li class="chapter" data-level="13" data-path="spatial.html"><a href="spatial.html"><i class="fa fa-check"></i><b>13</b> Spatial Data</a></li>
<li class="part"><span><b>IV Other Topics</b></span></li>
<li class="divider"></li>
<li><a href="https://github.com/norcalbiostat/MATH456_notes" target="blank">View source on Github</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Statistics II</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="categorical-predictors" class="section level2">
<h2><span class="header-section-number">5.1</span> Categorical Predictors</h2>
<p>Let’s continue to model the length of the iris petal based on the length of the sepal, controlling for species. But here we’ll keep species as a categorical variable. What happens if we just put the variable in the model?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(<span class="kw">lm</span>(Petal.Length <span class="op">~</span><span class="st"> </span>Sepal.Length <span class="op">+</span><span class="st"> </span>Species, <span class="dt">data=</span>iris))
## 
## Call:
## lm(formula = Petal.Length ~ Sepal.Length + Species, data = iris)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.76390 -0.17875  0.00716  0.17461  0.79954 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       -1.70234    0.23013  -7.397 1.01e-11 ***
## Sepal.Length       0.63211    0.04527  13.962  &lt; 2e-16 ***
## Speciesversicolor  2.21014    0.07047  31.362  &lt; 2e-16 ***
## Speciesvirginica   3.09000    0.09123  33.870  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.2826 on 146 degrees of freedom
## Multiple R-squared:  0.9749, Adjusted R-squared:  0.9744 
## F-statistic:  1890 on 3 and 146 DF,  p-value: &lt; 2.2e-16</code></pre></div>
<p>Examine the coefficient names, <code>Speciesversicolor</code> and <code>Speciesvirginica</code>. R (and most software packages) automatically take a categorical variable and turn it into a series of binary indicator variables. Let’s look at what the software program does in the background. Below is a sample of the iris data. The first column shows the row number, specifically I am only showing 2 sample rows from each species. The second column is the value of the sepal length, the third is the binary indicator for if the iris is from species <em>versicolor</em>, next the binary indicator for if the iris is from species <em>virginica</em>, and lastly the species as a 3 level categorical variable (which is what we’re used to seeing at this point.)</p>
<table>
<colgroup>
<col width="13%" />
<col width="19%" />
<col width="26%" />
<col width="25%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Sepal.Length</th>
<th align="center">Speciesversicolor</th>
<th align="center">Speciesvirginica</th>
<th align="center">Species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>1</strong></td>
<td align="center">5.1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">setosa</td>
</tr>
<tr class="even">
<td align="center"><strong>2</strong></td>
<td align="center">4.9</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">setosa</td>
</tr>
<tr class="odd">
<td align="center"><strong>51</strong></td>
<td align="center">7</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">versicolor</td>
</tr>
<tr class="even">
<td align="center"><strong>52</strong></td>
<td align="center">6.4</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">versicolor</td>
</tr>
<tr class="odd">
<td align="center"><strong>101</strong></td>
<td align="center">6.3</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">virginica</td>
</tr>
<tr class="even">
<td align="center"><strong>102</strong></td>
<td align="center">5.8</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">virginica</td>
</tr>
</tbody>
</table>
<div id="factor-variable-coding" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Factor variable coding</h3>
<ul>
<li>Most commonly known as “Dummy coding”. Not an informative term to use.</li>
<li>Better used term: Indicator variable</li>
<li>Math notation: <strong>I(gender == “Female”)</strong>.</li>
<li>A.k.a reference coding</li>
<li>For a nominal X with K categories, define K indicator variables.
<ul>
<li>Choose a reference (referent) category:</li>
<li>Leave it out</li>
<li>Use remaining K-1 in the regression.</li>
<li>Often, the largest category is chosen as the reference category.</li>
</ul></li>
</ul>
<p>For the iris example, 2 indicator variables are created for <em>versicolor</em> and <em>virginica</em>. Interpreting the regression coefficients are going to be <strong>compared to the reference group</strong>. In this case, it is species <em>setosa</em>.</p>
<p>The mathematical model is now written as follows, where <span class="math inline">\(x_{1}\)</span> is Sepal Length, <span class="math inline">\(x_{2}\)</span> is the indicator for <em>versicolor</em>, and <span class="math inline">\(x_{3}\)</span> the indicator for <em>virginica</em></p>
<p><span class="math display">\[ Y_{i} \sim \beta_{0} + \beta_{1}x_{i} + \beta_{2}x_{2i} + \beta_{3}x_{3i}+ \epsilon_{i}\]</span></p>
<p>Let’s look at the regression coefficients and their 95% confidence intervals from the main effects model again.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">main.eff.model &lt;-<span class="st"> </span><span class="kw">lm</span>(Petal.Length <span class="op">~</span><span class="st"> </span>Sepal.Length <span class="op">+</span><span class="st"> </span>Species, <span class="dt">data=</span>iris)
<span class="kw">pander</span>(main.eff.model)</code></pre></div>
<table style="width:96%;">
<caption>Fitting linear model: Petal.Length ~ Sepal.Length + Species</caption>
<colgroup>
<col width="33%" />
<col width="15%" />
<col width="18%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">-1.702</td>
<td align="center">0.2301</td>
<td align="center">-7.397</td>
<td align="center">1.005e-11</td>
</tr>
<tr class="even">
<td align="center"><strong>Sepal.Length</strong></td>
<td align="center">0.6321</td>
<td align="center">0.04527</td>
<td align="center">13.96</td>
<td align="center">1.121e-28</td>
</tr>
<tr class="odd">
<td align="center"><strong>Speciesversicolor</strong></td>
<td align="center">2.21</td>
<td align="center">0.07047</td>
<td align="center">31.36</td>
<td align="center">9.646e-67</td>
</tr>
<tr class="even">
<td align="center"><strong>Speciesvirginica</strong></td>
<td align="center">3.09</td>
<td align="center">0.09123</td>
<td align="center">33.87</td>
<td align="center">4.918e-71</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pander</span>(<span class="kw">confint</span>(main.eff.model))</code></pre></div>
<table style="width:58%;">
<colgroup>
<col width="33%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">2.5 %</th>
<th align="center">97.5 %</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">-2.157</td>
<td align="center">-1.248</td>
</tr>
<tr class="even">
<td align="center"><strong>Sepal.Length</strong></td>
<td align="center">0.5426</td>
<td align="center">0.7216</td>
</tr>
<tr class="odd">
<td align="center"><strong>Speciesversicolor</strong></td>
<td align="center">2.071</td>
<td align="center">2.349</td>
</tr>
<tr class="even">
<td align="center"><strong>Speciesvirginica</strong></td>
<td align="center">2.91</td>
<td align="center">3.27</td>
</tr>
</tbody>
</table>
<p>In this <em>main effects</em> model, Species only changes the intercept. The effect of species is not multiplied by Sepal length. The interpretations are the following:</p>
<ul>
<li><span class="math inline">\(b_{1}\)</span>: After controlling for species, Petal length significantly increases with the length of the sepal (0.63, 95% CI 0.54-0.72, p&lt;.0001).</li>
<li><span class="math inline">\(b_{2}\)</span>: <em>Versicolor</em> has on average 2.2cm longer petal lengths compared to <em>setosa</em> (95% CI 2.1-2.3, p&lt;.0001).</li>
<li><span class="math inline">\(b_{3}\)</span>: <em>Virginica</em> has on average 3.1cm longer petal lengths compared to <em>setosa</em> (95% CI 2.9-3.3, p&lt;.0001).</li>
</ul>
</div>
<div id="wald-test" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Wald test</h3>
<p>The Wald test is used for simultaneous tests of <span class="math inline">\(Q\)</span> variables in a model</p>
<p>Consider a model with <span class="math inline">\(P\)</span> variables and you want to test if <span class="math inline">\(Q\)</span> additional variables are useful.</p>
<ul>
<li><span class="math inline">\(H_{0}: Q\)</span> additional variables are useless, i.e., their <span class="math inline">\(\beta\)</span>’s all = 0<br />
</li>
<li><span class="math inline">\(H_{A}: Q\)</span> additional variables are useful</li>
</ul>
<p>The traditional test statistic that we’ve seen since Intro stats is <span class="math inline">\(\frac{\hat{\theta}-\theta}{\sqrt{Var(\hat{\theta})}}\)</span></p>
<p>The Wald test generalizes this test <em>any</em> linear combination of predictors.</p>
<p><span class="math display">\[
(R\hat{\theta}_{n}-r)^{&#39;}[R({\hat{V}}_{n}/n)R^{&#39;}]^{-1}
(R\hat{\theta}_{n}-r)
\quad \xrightarrow{\mathcal{D}}  \quad F(Q,n-P)
\]</span></p>
<p>Where <span class="math inline">\(\mathbf{R}\)</span> is the vector of coefficients for the <span class="math inline">\(\beta\)</span>, and <span class="math inline">\(\hat{V}_{n}\)</span> is a consistent estimator of the covariance matrix. Instead of a normal distribution, this test statistic has an <span class="math inline">\(F\)</span> distribution with <span class="math inline">\(Q\)</span> and <span class="math inline">\(n-P\)</span> degrees of freedom.</p>
<p>In the case where we’re testing <span class="math inline">\(\beta_{p}=\beta_{q}=...=0\)</span>, <span class="math inline">\(\mathbf{R}\)</span> is all 1’s.</p>
<p>This can be done in R by using the <code>regTermTest()</code> function in the <code>survey</code> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(survey)
<span class="kw">regTermTest</span>(main.eff.model, <span class="st">&quot;Species&quot;</span>) 
## Wald test for Species
##  in lm(formula = Petal.Length ~ Sepal.Length + Species, data = iris)
## F =  624.9854  on  2  and  146  df: p= &lt; 2.22e-16</code></pre></div>
<div id="example-1-employment-status-on-depression-score" class="section level5">
<h5><span class="header-section-number">5.1.2.0.1</span> Example 1: Employment status on depression score</h5>
<p>Consider a model to predict depression using age, employment status and whether or not the person was chronically ill in the past year as covariates. This example uses the cleaned depression data set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">depress &lt;-<span class="st"> </span><span class="kw">read.delim</span>(<span class="st">&quot;https://norcalbiostat.netlify.com/data/depress_081217.txt&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>,<span class="dt">sep=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>)
full_model &lt;-<span class="st"> </span><span class="kw">lm</span>(cesd <span class="op">~</span><span class="st"> </span>age <span class="op">+</span><span class="st"> </span>chronill <span class="op">+</span><span class="st"> </span>employ, <span class="dt">data=</span>depress)
<span class="kw">pander</span>(<span class="kw">summary</span>(full_model))</code></pre></div>
<table style="width:96%;">
<colgroup>
<col width="33%" />
<col width="15%" />
<col width="18%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">t value</th>
<th align="center">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">11.48</td>
<td align="center">1.502</td>
<td align="center">7.646</td>
<td align="center">3.191e-13</td>
</tr>
<tr class="even">
<td align="center"><strong>age</strong></td>
<td align="center">-0.133</td>
<td align="center">0.03514</td>
<td align="center">-3.785</td>
<td align="center">0.0001873</td>
</tr>
<tr class="odd">
<td align="center"><strong>chronill</strong></td>
<td align="center">2.688</td>
<td align="center">1.024</td>
<td align="center">2.625</td>
<td align="center">0.009121</td>
</tr>
<tr class="even">
<td align="center"><strong>employHouseperson</strong></td>
<td align="center">6.75</td>
<td align="center">1.797</td>
<td align="center">3.757</td>
<td align="center">0.0002083</td>
</tr>
<tr class="odd">
<td align="center"><strong>employIn School</strong></td>
<td align="center">1.967</td>
<td align="center">5.995</td>
<td align="center">0.328</td>
<td align="center">0.7431</td>
</tr>
<tr class="even">
<td align="center"><strong>employOther</strong></td>
<td align="center">4.897</td>
<td align="center">4.278</td>
<td align="center">1.145</td>
<td align="center">0.2533</td>
</tr>
<tr class="odd">
<td align="center"><strong>employPT</strong></td>
<td align="center">3.259</td>
<td align="center">1.472</td>
<td align="center">2.214</td>
<td align="center">0.02765</td>
</tr>
<tr class="even">
<td align="center"><strong>employRetired</strong></td>
<td align="center">3.233</td>
<td align="center">1.886</td>
<td align="center">1.714</td>
<td align="center">0.08756</td>
</tr>
<tr class="odd">
<td align="center"><strong>employUnemp</strong></td>
<td align="center">7.632</td>
<td align="center">2.339</td>
<td align="center">3.263</td>
<td align="center">0.001238</td>
</tr>
</tbody>
</table>
<table style="width:86%;">
<caption>Fitting linear model: cesd ~ age + chronill + employ</caption>
<colgroup>
<col width="20%" />
<col width="30%" />
<col width="12%" />
<col width="22%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Observations</th>
<th align="center">Residual Std. Error</th>
<th align="center"><span class="math inline">\(R^2\)</span></th>
<th align="center">Adjusted <span class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">294</td>
<td align="center">8.385</td>
<td align="center">0.1217</td>
<td align="center">0.09704</td>
</tr>
</tbody>
</table>
<p>The results of this model show that age and chronic illness are statistically associated with CESD (each p&lt;.006). However employment status shows mixed results. Some employment statuses are significantly different from the reference group, some are not. So overall, is employment status associated with depression?</p>
<p>Recall that employment is a categorical variable, and all the coefficient estimates shown are the effect of being in that income category has on depression <em>compared to</em> being employed full time. For example, the coefficient for PT employment is greater than zero, so they have a higher CESD score compared to someone who is fully employed.</p>
<p>But what about employment status overall? Not all employment categories are significantly different from FT status. To test that employment status affects CESD we need to do a global test that all <span class="math inline">\(\beta\)</span>’s are 0.</p>
<p><span class="math inline">\(H_{0}: \beta_{3} = \beta_{4} = \beta_{5} = \beta_{6} = \beta_{7} = \beta_{8} = 0\)</span><br />
<span class="math inline">\(H_{A}\)</span>: At least one <span class="math inline">\(\beta_{j}\)</span> is not 0.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">regTermTest</span>(full_model, <span class="st">&quot;employ&quot;</span>)
## Wald test for employ
##  in lm(formula = cesd ~ age + chronill + employ, data = depress)
## F =  4.153971  on  6  and  285  df: p= 0.0005092</code></pre></div>
<ul>
<li>Confirm that the degrees of freedom are correct. It should equal the # of categories in the variable you are testing, minus 1.
<ul>
<li>Employment has 7 levels, so <span class="math inline">\(df=6\)</span>.</li>
<li>Or equivalently, the degrees of freedom are the number of <span class="math inline">\(beta\)</span>’s you are testing to be 0.</li>
</ul></li>
</ul>
<p>The p-value of this Wald test is significant, thus employment significantly predicts CESD score.</p>
</div>
<div id="example-2-blood-pressure" class="section level4">
<h4><span class="header-section-number">5.1.2.1</span> Example 2: Blood Pressure</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="kw">url</span>(<span class="st">&quot;https://norcalbiostat.netlify.com/data/addhealth_clean.Rdata&quot;</span>))
addhealth<span class="op">$</span>smoke &lt;-<span class="st"> </span><span class="kw">ifelse</span>(addhealth<span class="op">$</span>eversmoke_c<span class="op">==</span><span class="st">&quot;Smoker&quot;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</code></pre></div>
<p>Consider a logistic model on smoking status (0= never smoked, 1=has smoked) using gender, income, and blood pressure class (<code>bp_class</code>) as predictors.</p>
<p><span class="math display">\[
logit(Y) = \beta_{0} + \beta_{1}\mbox{(female)} + \beta_{2}\mbox{(income)} + \beta_{3}\mbox{(Pre-HTN)} 
+ \beta_{4}\mbox{(HTN-I)} + \beta_{5}\mbox{(HTN-II)}
\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bp.mod &lt;-<span class="st"> </span><span class="kw">glm</span>(smoke <span class="op">~</span><span class="st"> </span>female_c <span class="op">+</span><span class="st"> </span>income <span class="op">+</span><span class="st"> </span>bp_class, <span class="dt">data=</span>addhealth, <span class="dt">family=</span><span class="st">&#39;binomial&#39;</span>)
<span class="kw">pander</span>(<span class="kw">summary</span>(bp.mod))</code></pre></div>
<table style="width:96%;">
<colgroup>
<col width="30%" />
<col width="18%" />
<col width="18%" />
<col width="13%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center"> </th>
<th align="center">Estimate</th>
<th align="center">Std. Error</th>
<th align="center">z value</th>
<th align="center">Pr(&gt;|z|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>(Intercept)</strong></td>
<td align="center">1.046</td>
<td align="center">0.1064</td>
<td align="center">9.836</td>
<td align="center">7.881e-23</td>
</tr>
<tr class="even">
<td align="center"><strong>female_cFemale</strong></td>
<td align="center">-0.6182</td>
<td align="center">0.07617</td>
<td align="center">-8.117</td>
<td align="center">4.798e-16</td>
</tr>
<tr class="odd">
<td align="center"><strong>income</strong></td>
<td align="center">-3.929e-06</td>
<td align="center">1.411e-06</td>
<td align="center">-2.785</td>
<td align="center">0.005346</td>
</tr>
<tr class="even">
<td align="center"><strong>bp_classPre-HTN</strong></td>
<td align="center">0.07289</td>
<td align="center">0.08206</td>
<td align="center">0.8882</td>
<td align="center">0.3745</td>
</tr>
<tr class="odd">
<td align="center"><strong>bp_classHTN-I</strong></td>
<td align="center">-0.02072</td>
<td align="center">0.1093</td>
<td align="center">-0.1895</td>
<td align="center">0.8497</td>
</tr>
<tr class="even">
<td align="center"><strong>bp_classHTN-II</strong></td>
<td align="center">0.02736</td>
<td align="center">0.1888</td>
<td align="center">0.1449</td>
<td align="center">0.8848</td>
</tr>
</tbody>
</table>
<p>(Dispersion parameter for binomial family taken to be 1 )</p>
<table style="width:67%;">
<colgroup>
<col width="29%" />
<col width="37%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="center">Null deviance:</td>
<td align="center">4853 on 3728 degrees of freedom</td>
</tr>
<tr class="even">
<td align="center">Residual deviance:</td>
<td align="center">4769 on 3723 degrees of freedom</td>
</tr>
</tbody>
</table>
<p>It is unlikely that blood pressure is associated with smoking status, all groups are not statistically significantly different from the reference group (all p-values are large). Let’s test that hypothesis formally using a Wald Test.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">regTermTest</span>(bp.mod, <span class="st">&quot;bp_class&quot;</span>)
## Wald test for bp_class
##  in glm(formula = smoke ~ female_c + income + bp_class, family = &quot;binomial&quot;, 
##     data = addhealth)
## F =  0.428004  on  3  and  3723  df: p= 0.73294</code></pre></div>
<p>The Wald Test has a large p-value of 0.73, thus blood pressure classification is not associated with smoking status.</p>
<ul>
<li>This means blood pressure classification should not be included in a model to explain smoking status.</li>
</ul>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="model-building.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="stratification.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
