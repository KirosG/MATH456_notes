[
["longitudinal.html", "Chapter 1 Longitudinal Data", " Chapter 1 Longitudinal Data What is Longitudinal Data? Repeated measures over time on subjects Different than other ways of repeated measures on clustered data (like family members, or kids in a classroom) Other similar data structures include time series data. Typically only have one subject (one stock market, sales from one product), and usually measured for a longer length of time. Key feature is that longitudinal data is ordered over time, linear distance, or some other “meta-meter” such as trial number, dose or length. What can we learn from longitudinal data? Population (average) response over time. Population average response over time between different groups. How individual responses behave over time. What is the estimate for the next observation over time? How do covariates affect the population mean time trend and individual variation? The rest of this chapter is organized as follows: Introduce the Pediatric Pain experiment and explore the resulting data. Explore some basic analyses that are often conducted on longitudinal data Conclude with fitting a random intercept model on this data. "],
["pediatric-pain-data.html", "1.1 Pediatric pain data", " 1.1 Pediatric pain data The Pediatric Pain data set used in this chapter is a result of a designed experiment. Most studies on human pain are observational. The data consist of up to four observations on 64 children aged 8-10. The response is the length of time in seconds that the child can tolerate keeping his or her arm in very cold water, a proxy measure of pain tolerance. After the cold becomes intolerable, the child removes his or her arm. The arm is toweled off, no harm is done. Two measurements were done on the first visit, then another 2 measurements were taken two weeks later during a second visit. After the arm was dried off study staff asked the child what they were thinking about during that trial. Children were classified into two groups depending on the child’s coping style during the trial. Attenders thought about the experiment, objects related to the experiment or their arm. Distracters distracted themselves during the test by thinking about something unrelated to the experiment: the wall, homework, their pet, etc. A treatment was administered before the fourth trial. This treatment was a 10 minute conversation where the child was either counseled to attend to the arm, distract themselves from the arm, or no advice was given. The study authors were interested in the main effects of treatment, coping style, and the interaction between the two. 1.1.1 Data sample kable(pain[1:10,]) id ses cs treatment sex age trial paintol l2paintol 1 73.5 attender attend female 10.083333 1 20.55 4.361066 1 73.5 attender attend female 10.083333 2 35.31 5.142005 1 73.5 attender attend female 10.083333 3 14.29 3.836934 1 73.5 attender attend female 10.083333 4 11.71 3.549669 2 74.7 distracter distract female 9.250000 1 28.13 4.814038 2 74.7 distracter distract female 9.250000 2 24.22 4.598127 2 74.7 distracter distract female 9.250000 3 15.86 3.987321 2 74.7 distracter distract female 9.250000 4 20.30 4.343408 3 81.5 attender no directions female 8.666667 1 12.00 3.584963 3 81.5 attender no directions female 8.666667 2 10.00 3.321928 id: participant ID ses: child’s socio-economic status cs: coping style. Assessed and assigned at the first visit. Attender : thought about the experiment, objects related to their their arm, Distracter : distracted themselves during the test treatment: Treatment group. Attend advised to pay attention to the arm Distract advised to pay attention to something other than the arm no direction no advice was given. trial: 1, 2, 3, 4 (time) paintol = The length of time in seconds arm was underwater. Proxy measure of pain tolerance. l2paintol = \\(\\log_{2}(paintol)\\) - Normality transformation. 1.1.2 Univariate Visualizations Pain tolerance The raw score for paintol is very skewed right. A \\(log_{2}\\) transformation was applied and found sufficient to achieve approximate normality. pain.dist &lt;- ggplot(pain, aes(x=paintol)) + geom_density() l2pain.dist &lt;- ggplot(pain, aes(l2paintol)) + geom_density() grid.arrange(pain.dist, l2pain.dist) Coping style and treatment There are nearly equal proportions of coping styles and treatment types. kable(table(pain$cs, pain$treatment)) attend distract no directions attender 40 48 40 distracter 44 44 40 "],
["visualizing-longitudinal-data.html", "1.2 Visualizing longitudinal data", " 1.2 Visualizing longitudinal data 1.2.1 Profile or spaghetti plots How does individual’s pain tolerance change over time/trials? What does the average trend look like? all &lt;- ggplot(pain, aes(trial, l2paintol)) + geom_point(alpha=.5) + theme_bw() + geom_path(aes(group=id), alpha=.5) + geom_smooth(col=&quot;blue&quot;, lwd=2) few &lt;- ggplot(pain[1:16,], aes(trial, l2paintol, group=id)) + geom_line() + geom_point() + theme_bw() grid.arrange(all, few, ncol=2) The average is around 5, with a slight decrease at time 2 and then relatively constant. The shading around the trendline shows that the variance across time points is pretty constant. The right hand plot shows the profile plot for the first 4 kids in the data set, notice how one path stops after trial 2? This tells us there is missing data in this data set that we will have to look out for. Quite a bit of variation across individuals, but what about the variation within person? I.e. how does the individual pain tolerance at each trial differ from the individual’s average pain tolerance. We’ll center the data around each person’s own average. With longitudinal data - the person is the cluster. person.ave &lt;- pain %&gt;% group_by(id) %&gt;% summarise(l2.ave = mean(l2paintol, na.rm=TRUE)) pain &lt;- pain %&gt;% left_join(person.ave) %&gt;% mutate(diff = l2.ave-l2paintol) # Always be very cautious when overwriting your data object! # Novice users recommended to create a new name. ggplot(pain, aes(trial, diff)) + geom_path(aes(group=id), alpha=.5) + geom_hline(yintercept=0, col=&quot;blue&quot;, lwd=2)+ theme_bw() Few individuals have large variations in their pain tolerance across time, and it appears as if those that had higher than average at trial 2, were lower than average at trial 3, and vice versa. 1.2.2 Correlation of pain tolerance within person across time To calculate the correlation of l2paintol between trials, we need to reshape the data to wide format. In wide data, the measure of pain tolerance for each trial is it’s own variable. # First select only the variable we want to transform wide pain.2.wide &lt;- pain %&gt;% select(id, trial, l2paintol) # Use the reshape() function to transform - this comes with baseR pw &lt;- reshape(pain.2.wide, idvar=&quot;id&quot;, timevar=&quot;trial&quot;, direction=&quot;wide&quot;) # then calculate and visualize the correlation of pain tolerance across time points. corrplot::corrplot.mixed(cor(pw[,-1], use = &#39;pairwise.complete.obs&#39;)) There is a fairly high correlation of pain tolerance between trials. "],
["analyze-pain-tolerance-across-coping-style.html", "1.3 Analyze pain tolerance across coping style", " 1.3 Analyze pain tolerance across coping style Visualize the distribution of pain tolerance across the different coping styles. pt.dist &lt;- ggplot(pain, aes(paintol, fill=cs)) + geom_density(alpha=.5) l2pt.dist &lt;- ggplot(pain, aes(l2paintol, fill=cs)) + geom_density(alpha=.5) grid.arrange(pt.dist, l2pt.dist, ncol=2) There appears to be a slight difference, but is it sigificantly different? Does it change over time? We’ll look at many different ways to approach this question. 1.3.1 Two Sample T-test Compare pain tolerance across coping styles at each trial. ggplot(pain, aes(l2paintol, fill=cs)) + geom_density(alpha=.5) + facet_wrap(~trial) There is a lot of overlap. Which differences are significant? We have no preconceived notion whether or not we can assume equal variances across groups, so we’ll run t-tests under both conditions. # Make an empty data frame to hold the p-values from the t-tests below. ttst &lt;- data.frame(eq.var=rep(NA,4), uneq.var=rep(NA,4), row.names=paste0(&quot;Trial&quot;, 1:4)) kable(ttst) # what does this look like empty? eq.var uneq.var Trial1 Trial2 Trial3 Trial4 # loop over 1 to 4 trials, conduct a t.test, extract the p-value and store it into this empty data frame for(t in 1:4){ ttst$eq.var[t] &lt;- t.test(l2paintol~cs, data=subset(pain, trial==t), var.equal=TRUE)$p.value ttst$uneq.var[t] &lt;- t.test(l2paintol~cs, data=subset(pain, trial==t), var.equal=FALSE)$p.value } kable(ttst, type=&#39;html&#39;, digits=4, caption=&quot;T-test p-values for a difference between averge pain tolerance across coping style groups&quot;) %&gt;% kable_styling(bootstrap_options = &quot;striped&quot;, full_width = F, position = &quot;center&quot;) # now it&#39;s full Table 1.1: T-test p-values for a difference between averge pain tolerance across coping style groups eq.var uneq.var Trial1 0.0524 0.0535 Trial2 0.0308 0.0305 Trial3 0.1041 0.1049 Trial4 0.1121 0.1104 Conclusion: regardless if we assume equal or unequal variances, there is a difference in the log2 pain tolerance between attending groups during trial 1 and 2 only, not during 3 or 4. 1.3.2 Averaged over the observed baseline values. Perhaps the difference we’re seeing is due to a difference at baseline between the two groups? Lets compute the baseline average over the first three responses and see if that changes across groups. baseline &lt;- pain %&gt;% filter(trial &lt; 4) %&gt;% group_by(cs, trial) %&gt;% summarise(ave.baseline.tol = mean(l2paintol, na.rm=TRUE)) ggplot(baseline, aes(ave.baseline.tol, fill=cs)) + geom_density(alpha=.5) Pretty clear baseline difference isn’t it? pander(t.test(ave.baseline.tol ~ cs, data=baseline)) Welch Two Sample t-test: ave.baseline.tol by cs (continued below) Test statistic df P value Alternative hypothesis -6.11 3.598 0.005095 * * two.sided mean in group attender mean in group distracter 4.504 5.037 Children who distracted themselves from the experiment could keep their arm in the ice water for an average of 5.04 seconds. This was signficantly longer compared to children who attended to the experiment, they averaged 4.5 seconds keeping their arm in the ice water (p=.005). 1.3.3 Missing Data We noticed earlier that there were some missing values in the data. Turns out that no one dropped out for reasons related to the experiment (i.e. they were uncomfortable), but there were some absences from school that day and a few broken arms. So far we’ve been ignoring that there is missing data. The table below shows that there are 6 individuals who are missing a score at time 3, but only 3 at time 4. This means that the time-stratified t-tests conducted earlier are on different sets of data. kable(table(is.na(pain$l2paintol), pain$trial)) 1 2 3 4 FALSE 63 63 58 61 TRUE 1 1 6 3 Is it the same individuals who are missing data? First let’s identify the rows with any missing values and save that as a vector of row numbers into miss.idx. miss.idx &lt;- which(is.na(pain$l2paintol)) miss.idx ## [1] 15 16 71 79 131 132 166 167 168 173 175 Then let’s see the id’s for those rows ids.with.missing &lt;- pain$id[miss.idx] ids.with.missing ## [1] 4 4 18 20 33 33 42 42 42 44 44 There are 6 unique individuals who are missing measurements for pain tolerance. What does their data look like? Half male, half distracters, 3 in the no directions treatment group, 2 in the distraction treatment group, and 1 in the attend group. Understanding the difference in characteristics between those with missing data and those without is important - and a topic we’ll come back to in a later chapter. kable(pain[pain$id %in% ids.with.missing,c(&#39;id&#39;, &#39;cs&#39;, &#39;treatment&#39;, &#39;sex&#39;, &#39;trial&#39;, &#39;paintol&#39; )], type=&#39;html&#39;, row.names=FALSE) %&gt;% kable_styling(bootstrap_options = &quot;striped&quot;, full_width = F, position = &quot;center&quot;) id cs treatment sex trial paintol 4 distracter attend male 1 15.53 4 distracter attend male 2 22.68 4 distracter attend male 3 4 distracter attend male 4 18 attender no directions male 1 22.48 18 attender no directions male 2 20.03 18 attender no directions male 3 18 attender no directions male 4 26.82 20 distracter no directions male 1 30.57 20 distracter no directions male 2 20.29 20 distracter no directions male 3 20 distracter no directions male 4 11.89 33 attender distract female 1 35.88 33 attender distract female 2 53.04 33 attender distract female 3 33 attender distract female 4 42 attender distract female 1 52.58 42 attender distract female 2 42 attender distract female 3 42 attender distract female 4 44 distracter no directions female 1 44 distracter no directions female 2 16.75 44 distracter no directions female 3 44 distracter no directions female 4 14.66 What if we just drop all records for all children with missing values at any time point? How does the results here compare to the previous test? First we have to go back and drop these 6 individuals from the data set before we calculate the baseline mean. base.nomiss &lt;- pain %&gt;% na.omit() %&gt;% filter(trial &lt; 4) %&gt;% group_by(cs, trial) %&gt;% summarise(ave.baseline.tol = mean(l2paintol)) ggplot(base.nomiss, aes(ave.baseline.tol, fill=cs)) + geom_density(alpha=.5) pander(t.test(ave.baseline.tol ~ cs, data=base.nomiss)) Welch Two Sample t-test: ave.baseline.tol by cs (continued below) Test statistic df P value Alternative hypothesis -6.615 4 0.002708 * * two.sided mean in group attender mean in group distracter 4.471 5.039 The average shift a little bit, the bimodality of the distribution of baseline pain tolerance is more clear. The conclusion remains the same however, the p-value was nearly doubled but when it’s already in the third digit, a move from 0.005 to 0.002 does not change your conclusion. 1.3.4 Paired t-test So far we’ve assumed that pain tolerance within person is independent across time points. That could be an unreasonable assumption, so let’s look at using paired T-tests between time points instead. Since now we’re treating the data as paired, we need the data back into wide format. We’ll apply reshape to the whole data set this time, turning all variables wide. We’ll keep using only the fully complete cases from here on out so that each analyses is on the same set of individuals. pain.wide &lt;- reshape(pain, idvar=&quot;id&quot;, timevar=&quot;trial&quot;, direction=&quot;wide&quot;) %&gt;% na.omit() names(pain.wide) # What does this data set look like now? ## [1] &quot;id&quot; &quot;ses.1&quot; &quot;cs.1&quot; &quot;treatment.1&quot; &quot;sex.1&quot; ## [6] &quot;age.1&quot; &quot;paintol.1&quot; &quot;l2paintol.1&quot; &quot;l2.ave.1&quot; &quot;diff.1&quot; ## [11] &quot;ses.2&quot; &quot;cs.2&quot; &quot;treatment.2&quot; &quot;sex.2&quot; &quot;age.2&quot; ## [16] &quot;paintol.2&quot; &quot;l2paintol.2&quot; &quot;l2.ave.2&quot; &quot;diff.2&quot; &quot;ses.3&quot; ## [21] &quot;cs.3&quot; &quot;treatment.3&quot; &quot;sex.3&quot; &quot;age.3&quot; &quot;paintol.3&quot; ## [26] &quot;l2paintol.3&quot; &quot;l2.ave.3&quot; &quot;diff.3&quot; &quot;ses.4&quot; &quot;cs.4&quot; ## [31] &quot;treatment.4&quot; &quot;sex.4&quot; &quot;age.4&quot; &quot;paintol.4&quot; &quot;l2paintol.4&quot; ## [36] &quot;l2.ave.4&quot; &quot;diff.4&quot; Each variable now has 4 entries, one for each time point. Some variables such as cs are time fixed, meaning they don’t change over time; cs.1 = cs.2 = cs.3 = cs=4. Other variables like paintol are time varying, they change within person across time. "],
["might-need-textbook-for-this-.html", "1.4 Might need textbook for this.", " 1.4 Might need textbook for this. "],
["what-about-just-the-4th-observation-minus-the-2nd.html", "1.5 What about just the 4th observation minus the 2nd?", " 1.5 What about just the 4th observation minus the 2nd? #t.test(data=base.nomiss) "],
["random-intercept-model.html", "1.6 Random Intercept Model", " 1.6 Random Intercept Model The random intercept model combines aspects of the various simple analyses in one large model that uses all the data available and in an appropriate fashion. Since we have a specified correlation structure, we’ll use the lme function found in the nlme package and change the correlation structure to an Autoregressive with lag 1 (AR1) structure. The value= argument is an estimate of the value of the lag 1 autocorrelation. Where did the 0.7 come from? library(nlme) ar.model &lt;- lme(l2paintol ~ cs, random = ~ 1|id, cor = corAR1(value = 0.7, form=~1|id), data=pain, na.action=na.omit) summary(ar.model) ## Linear mixed-effects model fit by REML ## Data: pain ## AIC BIC logLik ## 599.8891 617.3544 -294.9446 ## ## Random effects: ## Formula: ~1 | id ## (Intercept) Residual ## StdDev: 0.8982031 0.6173987 ## ## Correlation Structure: AR(1) ## Formula: ~1 | id ## Parameter estimate(s): ## Phi ## 0.1098905 ## Fixed effects: l2paintol ~ cs ## Value Std.Error DF t-value p-value ## (Intercept) 4.538559 0.1704000 181 26.634729 0.0000 ## csdistracter 0.455238 0.2407376 62 1.891012 0.0633 ## Correlation: ## (Intr) ## csdistracter -0.708 ## ## Standardized Within-Group Residuals: ## Min Q1 Med Q3 Max ## -2.58503556 -0.42732434 -0.07170972 0.41710872 3.95545284 ## ## Number of Observations: 245 ## Number of Groups: 64 The model converged - don’t forget to check this. There was no error message in the output saying it didn’t converge, so we’re good. let’s look at and interpret the fixed effects stargazer::stargazer(ar.model, single.row=TRUE, ci=TRUE, type=&#39;html&#39;) Dependent variable: l2paintol csdistracter 0.455* (-0.017, 0.927) Constant 4.539*** (4.205, 4.873) Observations 245 Log Likelihood -294.945 Akaike Inf. Crit. 599.889 Bayesian Inf. Crit. 617.354 Note: p&lt;0.1; p&lt;0.05; p&lt;0.01 "],
["additional-resources.html", "1.7 Additional Resources", " 1.7 Additional Resources Modeling Longitudinal Data, Robert E. Weiss (2005) https://www.springer.com/us/book/9780387402710 Modeling time series data https://www.datascience.com/blog/introduction-to-forecasting-with-arima-in-r-learn-data-science-tutorials "]
]
