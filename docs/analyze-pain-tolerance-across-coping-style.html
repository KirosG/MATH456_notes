<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Applied Statistics II</title>
  <meta name="description" content="Course notes for MATH 456 at CSU Chico">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Applied Statistics II" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course notes for MATH 456 at CSU Chico" />
  <meta name="github-repo" content="norcalbiostat/MATH456_notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Applied Statistics II" />
  
  <meta name="twitter:description" content="Course notes for MATH 456 at CSU Chico" />
  

<meta name="author" content="Robin A. Donatello and Edward A. Roualdes">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="visualizing-longitudinal-data.html">
<link rel="next" href="might-need-textbook-for-this-.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Statistics II course notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="longitudinal.html"><a href="longitudinal.html"><i class="fa fa-check"></i><b>1</b> Longitudinal Data</a><ul>
<li class="chapter" data-level="1.1" data-path="pediatric-pain-data.html"><a href="pediatric-pain-data.html"><i class="fa fa-check"></i><b>1.1</b> Pediatric pain data</a><ul>
<li class="chapter" data-level="1.1.1" data-path="pediatric-pain-data.html"><a href="pediatric-pain-data.html#data-sample"><i class="fa fa-check"></i><b>1.1.1</b> Data sample</a></li>
<li class="chapter" data-level="1.1.2" data-path="pediatric-pain-data.html"><a href="pediatric-pain-data.html#univariate-visualizations"><i class="fa fa-check"></i><b>1.1.2</b> Univariate Visualizations</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="visualizing-longitudinal-data.html"><a href="visualizing-longitudinal-data.html"><i class="fa fa-check"></i><b>1.2</b> Visualizing longitudinal data</a><ul>
<li class="chapter" data-level="1.2.1" data-path="visualizing-longitudinal-data.html"><a href="visualizing-longitudinal-data.html#profile-or-spaghetti-plots"><i class="fa fa-check"></i><b>1.2.1</b> Profile or spaghetti plots</a></li>
<li class="chapter" data-level="1.2.2" data-path="visualizing-longitudinal-data.html"><a href="visualizing-longitudinal-data.html#corrmat"><i class="fa fa-check"></i><b>1.2.2</b> Correlation of pain tolerance within person across time</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="analyze-pain-tolerance-across-coping-style.html"><a href="analyze-pain-tolerance-across-coping-style.html"><i class="fa fa-check"></i><b>1.3</b> Analyze pain tolerance across coping style</a><ul>
<li class="chapter" data-level="1.3.1" data-path="analyze-pain-tolerance-across-coping-style.html"><a href="analyze-pain-tolerance-across-coping-style.html#two-sample-t-test"><i class="fa fa-check"></i><b>1.3.1</b> Two Sample T-test</a></li>
<li class="chapter" data-level="1.3.2" data-path="analyze-pain-tolerance-across-coping-style.html"><a href="analyze-pain-tolerance-across-coping-style.html#averaged-over-the-observed-baseline-values."><i class="fa fa-check"></i><b>1.3.2</b> Averaged over the observed baseline values.</a></li>
<li class="chapter" data-level="1.3.3" data-path="analyze-pain-tolerance-across-coping-style.html"><a href="analyze-pain-tolerance-across-coping-style.html#missing-data"><i class="fa fa-check"></i><b>1.3.3</b> Missing Data</a></li>
<li class="chapter" data-level="1.3.4" data-path="analyze-pain-tolerance-across-coping-style.html"><a href="analyze-pain-tolerance-across-coping-style.html#paired-t-test"><i class="fa fa-check"></i><b>1.3.4</b> Paired t-test</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="might-need-textbook-for-this-.html"><a href="might-need-textbook-for-this-.html"><i class="fa fa-check"></i><b>1.4</b> Might need textbook for this.</a></li>
<li class="chapter" data-level="1.5" data-path="what-about-just-the-4th-observation-minus-the-2nd.html"><a href="what-about-just-the-4th-observation-minus-the-2nd.html"><i class="fa fa-check"></i><b>1.5</b> What about just the 4th observation minus the 2nd?</a></li>
<li class="chapter" data-level="1.6" data-path="random-intercept-model.html"><a href="random-intercept-model.html"><i class="fa fa-check"></i><b>1.6</b> Random Intercept Model</a></li>
<li class="chapter" data-level="1.7" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>1.7</b> Additional Resources</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/norcalbiostat/MATH456_notes" target="blank">View source on Github</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Statistics II</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="analyze-pain-tolerance-across-coping-style" class="section level2">
<h2><span class="header-section-number">1.3</span> Analyze pain tolerance across coping style</h2>
<p>Visualize the distribution of pain tolerance across the different coping styles.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pt.dist   &lt;-<span class="st"> </span><span class="kw">ggplot</span>(pain, <span class="kw">aes</span>(paintol, <span class="dt">fill=</span>cs)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha=</span>.<span class="dv">5</span>)
l2pt.dist &lt;-<span class="st"> </span><span class="kw">ggplot</span>(pain, <span class="kw">aes</span>(l2paintol, <span class="dt">fill=</span>cs)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha=</span>.<span class="dv">5</span>)
<span class="kw">grid.arrange</span>(pt.dist, l2pt.dist, <span class="dt">ncol=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="longitudinal_files/figure-html/unnamed-chunk-9-1.png" width="960" /></p>
<p>There appears to be a slight difference, but is it sigificantly different? Does it change over time? Weâ€™ll look at many different ways to approach this question.</p>
<div id="two-sample-t-test" class="section level3">
<h3><span class="header-section-number">1.3.1</span> Two Sample T-test</h3>
<p>Compare pain tolerance across coping styles at each trial.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(pain, <span class="kw">aes</span>(l2paintol, <span class="dt">fill=</span>cs)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha=</span>.<span class="dv">5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>trial)</code></pre></div>
<p><img src="longitudinal_files/figure-html/unnamed-chunk-10-1.png" width="960" /></p>
<p>There is a lot of overlap. Which differences are significant? We have no preconceived notion whether or not we can assume equal variances across groups, so weâ€™ll run t-tests under both conditions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Make an empty data frame to hold the p-values from the t-tests below.</span>
ttst &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">eq.var=</span><span class="kw">rep</span>(<span class="ot">NA</span>,<span class="dv">4</span>), <span class="dt">uneq.var=</span><span class="kw">rep</span>(<span class="ot">NA</span>,<span class="dv">4</span>), 
                   <span class="dt">row.names=</span><span class="kw">paste0</span>(<span class="st">&quot;Trial&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>))
<span class="kw">kable</span>(ttst) <span class="co"># what does this look like empty? </span></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">eq.var</th>
<th align="left">uneq.var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Trial1</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td>Trial2</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td>Trial3</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td>Trial4</td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
<span class="co"># loop over 1 to 4 trials, conduct a t.test, extract the p-value and store it into this empty data frame</span>
<span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){
  ttst<span class="op">$</span>eq.var[t]   &lt;-<span class="st"> </span><span class="kw">t.test</span>(l2paintol<span class="op">~</span>cs, <span class="dt">data=</span><span class="kw">subset</span>(pain, trial<span class="op">==</span>t), <span class="dt">var.equal=</span><span class="ot">TRUE</span>)<span class="op">$</span>p.value
  ttst<span class="op">$</span>uneq.var[t] &lt;-<span class="st"> </span><span class="kw">t.test</span>(l2paintol<span class="op">~</span>cs, <span class="dt">data=</span><span class="kw">subset</span>(pain, trial<span class="op">==</span>t), <span class="dt">var.equal=</span><span class="ot">FALSE</span>)<span class="op">$</span>p.value
}
<span class="kw">kable</span>(ttst, <span class="dt">type=</span><span class="st">&#39;html&#39;</span>, <span class="dt">digits=</span><span class="dv">4</span>,  
      <span class="dt">caption=</span><span class="st">&quot;T-test p-values for a difference between averge pain tolerance across coping style groups&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>, <span class="dt">full_width =</span> F, <span class="dt">position =</span> <span class="st">&quot;center&quot;</span>) <span class="co"># now it&#39;s full</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-11">Table 1.1: </span>T-test p-values for a difference between averge pain tolerance across coping style groups</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">eq.var</th>
<th align="right">uneq.var</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Trial1</td>
<td align="right">0.0524</td>
<td align="right">0.0535</td>
</tr>
<tr class="even">
<td>Trial2</td>
<td align="right">0.0308</td>
<td align="right">0.0305</td>
</tr>
<tr class="odd">
<td>Trial3</td>
<td align="right">0.1041</td>
<td align="right">0.1049</td>
</tr>
<tr class="even">
<td>Trial4</td>
<td align="right">0.1121</td>
<td align="right">0.1104</td>
</tr>
</tbody>
</table>
<p>Conclusion: regardless if we assume equal or unequal variances, there is a difference in the log2 pain tolerance between attending groups during trial 1 and 2 only, not during 3 or 4.</p>
</div>
<div id="averaged-over-the-observed-baseline-values." class="section level3">
<h3><span class="header-section-number">1.3.2</span> Averaged over the observed baseline values.</h3>
<p>Perhaps the difference weâ€™re seeing is due to a difference at baseline between the two groups? Lets compute the baseline average over the first three responses and see if that changes across groups.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">baseline &lt;-<span class="st"> </span>pain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(trial <span class="op">&lt;</span><span class="st"> </span><span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">             </span><span class="kw">group_by</span>(cs, trial) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">             </span><span class="kw">summarise</span>(<span class="dt">ave.baseline.tol =</span> <span class="kw">mean</span>(l2paintol, <span class="dt">na.rm=</span><span class="ot">TRUE</span>))

<span class="kw">ggplot</span>(baseline, <span class="kw">aes</span>(ave.baseline.tol, <span class="dt">fill=</span>cs)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha=</span>.<span class="dv">5</span>)</code></pre></div>
<p><img src="longitudinal_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>Pretty clear baseline difference isnâ€™t it?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pander</span>(<span class="kw">t.test</span>(ave.baseline.tol <span class="op">~</span><span class="st"> </span>cs, <span class="dt">data=</span>baseline))</code></pre></div>
<table style="width:89%;">
<caption>Welch Two Sample t-test: <code>ave.baseline.tol</code> by <code>cs</code> (continued below)</caption>
<colgroup>
<col width="23%" />
<col width="11%" />
<col width="20%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Test statistic</th>
<th align="center">df</th>
<th align="center">P value</th>
<th align="center">Alternative hypothesis</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">-6.11</td>
<td align="center">3.598</td>
<td align="center">0.005095 * *</td>
<td align="center">two.sided</td>
</tr>
</tbody>
</table>
<table style="width:71%;">
<colgroup>
<col width="34%" />
<col width="36%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">mean in group attender</th>
<th align="center">mean in group distracter</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">4.504</td>
<td align="center">5.037</td>
</tr>
</tbody>
</table>
<p>Children who distracted themselves from the experiment could keep their arm in the ice water for an average of 5.04 seconds. This was signficantly longer compared to children who attended to the experiment, they averaged 4.5 seconds keeping their arm in the ice water (p=.005).</p>
</div>
<div id="missing-data" class="section level3">
<h3><span class="header-section-number">1.3.3</span> Missing Data</h3>
<p>We noticed earlier that there were some missing values in the data. Turns out that no one dropped out for reasons related to the experiment (i.e.Â they were uncomfortable), but there were some absences from school that day and a few broken arms.</p>
<p>So far weâ€™ve been ignoring that there is missing data. The table below shows that there are 6 individuals who are missing a score at time 3, but only 3 at time 4. This means that the time-stratified t-tests conducted earlier are on different sets of data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(<span class="kw">table</span>(<span class="kw">is.na</span>(pain<span class="op">$</span>l2paintol), pain<span class="op">$</span>trial))</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">1</th>
<th align="right">2</th>
<th align="right">3</th>
<th align="right">4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>FALSE</td>
<td align="right">63</td>
<td align="right">63</td>
<td align="right">58</td>
<td align="right">61</td>
</tr>
<tr class="even">
<td>TRUE</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">6</td>
<td align="right">3</td>
</tr>
</tbody>
</table>
<p>Is it the same individuals who are missing data? First letâ€™s identify the rows with any missing values and save that as a vector of row numbers into <code>miss.idx</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">miss.idx &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">is.na</span>(pain<span class="op">$</span>l2paintol))
miss.idx
##  [1]  15  16  71  79 131 132 166 167 168 173 175</code></pre></div>
<p>Then letâ€™s see the idâ€™s for those rows</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ids.with.missing &lt;-<span class="st"> </span>pain<span class="op">$</span>id[miss.idx]
ids.with.missing
##  [1]  4  4 18 20 33 33 42 42 42 44 44</code></pre></div>
<p>There are 6 unique individuals who are missing measurements for pain tolerance. What does their data look like? Half male, half distracters, 3 in the no directions treatment group, 2 in the distraction treatment group, and 1 in the attend group. Understanding the difference in characteristics between those with missing data and those without is important - and a topic weâ€™ll come back to in a later chapter.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kable</span>(pain[pain<span class="op">$</span>id <span class="op">%in%</span><span class="st"> </span>ids.with.missing,<span class="kw">c</span>(<span class="st">&#39;id&#39;</span>, <span class="st">&#39;cs&#39;</span>, <span class="st">&#39;treatment&#39;</span>, <span class="st">&#39;sex&#39;</span>, <span class="st">&#39;trial&#39;</span>, <span class="st">&#39;paintol&#39;</span> )], 
      <span class="dt">type=</span><span class="st">&#39;html&#39;</span>, <span class="dt">row.names=</span><span class="ot">FALSE</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">      </span><span class="kw">kable_styling</span>(<span class="dt">bootstrap_options =</span> <span class="st">&quot;striped&quot;</span>, <span class="dt">full_width =</span> F, <span class="dt">position =</span> <span class="st">&quot;center&quot;</span>)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">id</th>
<th align="left">cs</th>
<th align="left">treatment</th>
<th align="left">sex</th>
<th align="right">trial</th>
<th align="right">paintol</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="left">distracter</td>
<td align="left">attend</td>
<td align="left">male</td>
<td align="right">1</td>
<td align="right">15.53</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">distracter</td>
<td align="left">attend</td>
<td align="left">male</td>
<td align="right">2</td>
<td align="right">22.68</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">distracter</td>
<td align="left">attend</td>
<td align="left">male</td>
<td align="right">3</td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">distracter</td>
<td align="left">attend</td>
<td align="left">male</td>
<td align="right">4</td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="left">attender</td>
<td align="left">no directions</td>
<td align="left">male</td>
<td align="right">1</td>
<td align="right">22.48</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="left">attender</td>
<td align="left">no directions</td>
<td align="left">male</td>
<td align="right">2</td>
<td align="right">20.03</td>
</tr>
<tr class="odd">
<td align="right">18</td>
<td align="left">attender</td>
<td align="left">no directions</td>
<td align="left">male</td>
<td align="right">3</td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="left">attender</td>
<td align="left">no directions</td>
<td align="left">male</td>
<td align="right">4</td>
<td align="right">26.82</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="left">distracter</td>
<td align="left">no directions</td>
<td align="left">male</td>
<td align="right">1</td>
<td align="right">30.57</td>
</tr>
<tr class="even">
<td align="right">20</td>
<td align="left">distracter</td>
<td align="left">no directions</td>
<td align="left">male</td>
<td align="right">2</td>
<td align="right">20.29</td>
</tr>
<tr class="odd">
<td align="right">20</td>
<td align="left">distracter</td>
<td align="left">no directions</td>
<td align="left">male</td>
<td align="right">3</td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="right">20</td>
<td align="left">distracter</td>
<td align="left">no directions</td>
<td align="left">male</td>
<td align="right">4</td>
<td align="right">11.89</td>
</tr>
<tr class="odd">
<td align="right">33</td>
<td align="left">attender</td>
<td align="left">distract</td>
<td align="left">female</td>
<td align="right">1</td>
<td align="right">35.88</td>
</tr>
<tr class="even">
<td align="right">33</td>
<td align="left">attender</td>
<td align="left">distract</td>
<td align="left">female</td>
<td align="right">2</td>
<td align="right">53.04</td>
</tr>
<tr class="odd">
<td align="right">33</td>
<td align="left">attender</td>
<td align="left">distract</td>
<td align="left">female</td>
<td align="right">3</td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="right">33</td>
<td align="left">attender</td>
<td align="left">distract</td>
<td align="left">female</td>
<td align="right">4</td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="right">42</td>
<td align="left">attender</td>
<td align="left">distract</td>
<td align="left">female</td>
<td align="right">1</td>
<td align="right">52.58</td>
</tr>
<tr class="even">
<td align="right">42</td>
<td align="left">attender</td>
<td align="left">distract</td>
<td align="left">female</td>
<td align="right">2</td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="right">42</td>
<td align="left">attender</td>
<td align="left">distract</td>
<td align="left">female</td>
<td align="right">3</td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="right">42</td>
<td align="left">attender</td>
<td align="left">distract</td>
<td align="left">female</td>
<td align="right">4</td>
<td align="right"></td>
</tr>
<tr class="odd">
<td align="right">44</td>
<td align="left">distracter</td>
<td align="left">no directions</td>
<td align="left">female</td>
<td align="right">1</td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="right">44</td>
<td align="left">distracter</td>
<td align="left">no directions</td>
<td align="left">female</td>
<td align="right">2</td>
<td align="right">16.75</td>
</tr>
<tr class="odd">
<td align="right">44</td>
<td align="left">distracter</td>
<td align="left">no directions</td>
<td align="left">female</td>
<td align="right">3</td>
<td align="right"></td>
</tr>
<tr class="even">
<td align="right">44</td>
<td align="left">distracter</td>
<td align="left">no directions</td>
<td align="left">female</td>
<td align="right">4</td>
<td align="right">14.66</td>
</tr>
</tbody>
</table>
<p>What if we just drop all records for all children with missing values at any time point? How does the results here compare to the previous test? First we have to go back and drop these 6 individuals from the data set <em>before</em> we calculate the baseline mean.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">base.nomiss &lt;-<span class="st"> </span>pain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(trial <span class="op">&lt;</span><span class="st"> </span><span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                </span><span class="kw">group_by</span>(cs, trial) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">                </span><span class="kw">summarise</span>(<span class="dt">ave.baseline.tol =</span> <span class="kw">mean</span>(l2paintol))

<span class="kw">ggplot</span>(base.nomiss, <span class="kw">aes</span>(ave.baseline.tol, <span class="dt">fill=</span>cs)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">alpha=</span>.<span class="dv">5</span>)</code></pre></div>
<p><img src="longitudinal_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pander</span>(<span class="kw">t.test</span>(ave.baseline.tol <span class="op">~</span><span class="st"> </span>cs, <span class="dt">data=</span>base.nomiss))</code></pre></div>
<table style="width:85%;">
<caption>Welch Two Sample t-test: <code>ave.baseline.tol</code> by <code>cs</code> (continued below)</caption>
<colgroup>
<col width="23%" />
<col width="6%" />
<col width="20%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Test statistic</th>
<th align="center">df</th>
<th align="center">P value</th>
<th align="center">Alternative hypothesis</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">-6.615</td>
<td align="center">4</td>
<td align="center">0.002708 * *</td>
<td align="center">two.sided</td>
</tr>
</tbody>
</table>
<table style="width:71%;">
<colgroup>
<col width="34%" />
<col width="36%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">mean in group attender</th>
<th align="center">mean in group distracter</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">4.471</td>
<td align="center">5.039</td>
</tr>
</tbody>
</table>
<p>The average shift a little bit, the bimodality of the distribution of baseline pain tolerance is more clear. The conclusion remains the same however, the p-value was nearly doubled but when itâ€™s already in the third digit, a move from 0.005 to 0.002 does not change your conclusion.</p>
</div>
<div id="paired-t-test" class="section level3">
<h3><span class="header-section-number">1.3.4</span> Paired t-test</h3>
<p>So far weâ€™ve assumed that pain tolerance within person is independent across time points. That could be an unreasonable assumption, so letâ€™s look at using paired T-tests between time points instead. Since now weâ€™re treating the data as paired, we need the data back into wide format. Weâ€™ll apply <code>reshape</code> to the whole data set this time, turning <em>all</em> variables wide. Weâ€™ll keep using only the fully complete cases from here on out so that each analyses is on the same set of individuals.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pain.wide &lt;-<span class="st"> </span><span class="kw">reshape</span>(pain, <span class="dt">idvar=</span><span class="st">&quot;id&quot;</span>, <span class="dt">timevar=</span><span class="st">&quot;trial&quot;</span>, <span class="dt">direction=</span><span class="st">&quot;wide&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>()
<span class="kw">names</span>(pain.wide) <span class="co"># What does this data set look like now? </span>
##  [1] &quot;id&quot;          &quot;ses.1&quot;       &quot;cs.1&quot;        &quot;treatment.1&quot; &quot;sex.1&quot;      
##  [6] &quot;age.1&quot;       &quot;paintol.1&quot;   &quot;l2paintol.1&quot; &quot;l2.ave.1&quot;    &quot;diff.1&quot;     
## [11] &quot;ses.2&quot;       &quot;cs.2&quot;        &quot;treatment.2&quot; &quot;sex.2&quot;       &quot;age.2&quot;      
## [16] &quot;paintol.2&quot;   &quot;l2paintol.2&quot; &quot;l2.ave.2&quot;    &quot;diff.2&quot;      &quot;ses.3&quot;      
## [21] &quot;cs.3&quot;        &quot;treatment.3&quot; &quot;sex.3&quot;       &quot;age.3&quot;       &quot;paintol.3&quot;  
## [26] &quot;l2paintol.3&quot; &quot;l2.ave.3&quot;    &quot;diff.3&quot;      &quot;ses.4&quot;       &quot;cs.4&quot;       
## [31] &quot;treatment.4&quot; &quot;sex.4&quot;       &quot;age.4&quot;       &quot;paintol.4&quot;   &quot;l2paintol.4&quot;
## [36] &quot;l2.ave.4&quot;    &quot;diff.4&quot;</code></pre></div>
<p>Each variable now has 4 entries, one for each time point. Some variables such as <code>cs</code> are <strong>time fixed</strong>, meaning they donâ€™t change over time; <code>cs.1</code> = <code>cs.2</code> = <code>cs.3</code> = <code>cs=4</code>. Other variables like <code>paintol</code> are <strong>time varying</strong>, they change within person across time.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="visualizing-longitudinal-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="might-need-textbook-for-this-.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
