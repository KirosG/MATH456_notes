<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Applied Statistics II</title>
  <meta name="description" content="Course notes for MATH 456 at CSU Chico">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Applied Statistics II" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Course notes for MATH 456 at CSU Chico" />
  <meta name="github-repo" content="norcalbiostat/MATH456_notes" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Applied Statistics II" />
  
  <meta name="twitter:description" content="Course notes for MATH 456 at CSU Chico" />
  

<meta name="author" content="Robin A. Donatello and Edward A. Roualdes">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="pediatric-pain-data.html">
<link rel="next" href="analyze-pain-tolerance-across-coping-style.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Statistics II course notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="longitudinal.html"><a href="longitudinal.html"><i class="fa fa-check"></i><b>1</b> Longitudinal Data</a><ul>
<li class="chapter" data-level="1.1" data-path="pediatric-pain-data.html"><a href="pediatric-pain-data.html"><i class="fa fa-check"></i><b>1.1</b> Pediatric pain data</a><ul>
<li class="chapter" data-level="1.1.1" data-path="pediatric-pain-data.html"><a href="pediatric-pain-data.html#data-sample"><i class="fa fa-check"></i><b>1.1.1</b> Data sample</a></li>
<li class="chapter" data-level="1.1.2" data-path="pediatric-pain-data.html"><a href="pediatric-pain-data.html#univariate-visualizations"><i class="fa fa-check"></i><b>1.1.2</b> Univariate Visualizations</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="visualizing-longitudinal-data.html"><a href="visualizing-longitudinal-data.html"><i class="fa fa-check"></i><b>1.2</b> Visualizing longitudinal data</a><ul>
<li class="chapter" data-level="1.2.1" data-path="visualizing-longitudinal-data.html"><a href="visualizing-longitudinal-data.html#profile-or-spaghetti-plots"><i class="fa fa-check"></i><b>1.2.1</b> Profile or spaghetti plots</a></li>
<li class="chapter" data-level="1.2.2" data-path="visualizing-longitudinal-data.html"><a href="visualizing-longitudinal-data.html#corrmat"><i class="fa fa-check"></i><b>1.2.2</b> Correlation of pain tolerance within person across time</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="analyze-pain-tolerance-across-coping-style.html"><a href="analyze-pain-tolerance-across-coping-style.html"><i class="fa fa-check"></i><b>1.3</b> Analyze pain tolerance across coping style</a><ul>
<li class="chapter" data-level="1.3.1" data-path="analyze-pain-tolerance-across-coping-style.html"><a href="analyze-pain-tolerance-across-coping-style.html#two-sample-t-test"><i class="fa fa-check"></i><b>1.3.1</b> Two Sample T-test</a></li>
<li class="chapter" data-level="1.3.2" data-path="analyze-pain-tolerance-across-coping-style.html"><a href="analyze-pain-tolerance-across-coping-style.html#averaged-over-the-observed-baseline-values."><i class="fa fa-check"></i><b>1.3.2</b> Averaged over the observed baseline values.</a></li>
<li class="chapter" data-level="1.3.3" data-path="analyze-pain-tolerance-across-coping-style.html"><a href="analyze-pain-tolerance-across-coping-style.html#missing-data"><i class="fa fa-check"></i><b>1.3.3</b> Missing Data</a></li>
<li class="chapter" data-level="1.3.4" data-path="analyze-pain-tolerance-across-coping-style.html"><a href="analyze-pain-tolerance-across-coping-style.html#paired-t-test"><i class="fa fa-check"></i><b>1.3.4</b> Paired t-test</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="might-need-textbook-for-this-.html"><a href="might-need-textbook-for-this-.html"><i class="fa fa-check"></i><b>1.4</b> Might need textbook for this.</a></li>
<li class="chapter" data-level="1.5" data-path="what-about-just-the-4th-observation-minus-the-2nd.html"><a href="what-about-just-the-4th-observation-minus-the-2nd.html"><i class="fa fa-check"></i><b>1.5</b> What about just the 4th observation minus the 2nd?</a></li>
<li class="chapter" data-level="1.6" data-path="random-intercept-model.html"><a href="random-intercept-model.html"><i class="fa fa-check"></i><b>1.6</b> Random Intercept Model</a></li>
<li class="chapter" data-level="1.7" data-path="additional-resources.html"><a href="additional-resources.html"><i class="fa fa-check"></i><b>1.7</b> Additional Resources</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/norcalbiostat/MATH456_notes" target="blank">View source on Github</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Statistics II</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="visualizing-longitudinal-data" class="section level2">
<h2><span class="header-section-number">1.2</span> Visualizing longitudinal data</h2>
<div id="profile-or-spaghetti-plots" class="section level3">
<h3><span class="header-section-number">1.2.1</span> Profile or spaghetti plots</h3>
<p>How does individualâ€™s pain tolerance change over time/trials? What does the average trend look like?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">all &lt;-<span class="st"> </span><span class="kw">ggplot</span>(pain, <span class="kw">aes</span>(trial, l2paintol)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span>.<span class="dv">5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">        </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">group=</span>id), <span class="dt">alpha=</span>.<span class="dv">5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)
few &lt;-<span class="st"> </span><span class="kw">ggplot</span>(pain[<span class="dv">1</span><span class="op">:</span><span class="dv">16</span>,], <span class="kw">aes</span>(trial, l2paintol, <span class="dt">group=</span>id)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">        </span><span class="kw">theme_bw</span>() 
<span class="kw">grid.arrange</span>(all, few, <span class="dt">ncol=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="longitudinal_files/figure-html/unnamed-chunk-6-1.png" width="960" /></p>
<p>The average is around 5, with a slight decrease at time 2 and then relatively constant. The shading around the trendline shows that the variance across time points is pretty constant. The right hand plot shows the profile plot for the first 4 kids in the data set, notice how one path stops after trial 2? This tells us there is missing data in this data set that we will have to look out for.</p>
<p>Quite a bit of variation across individuals, but what about the variation within person? I.e. how does the individual pain tolerance at each trial differ from the individualâ€™s average pain tolerance. Weâ€™ll <em>center</em> the data around each personâ€™s own average. With longitudinal data - the person is the cluster.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">person.ave &lt;-<span class="st"> </span>pain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarise</span>(<span class="dt">l2.ave =</span> <span class="kw">mean</span>(l2paintol, <span class="dt">na.rm=</span><span class="ot">TRUE</span>))
pain &lt;-<span class="st"> </span>pain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(person.ave) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">diff =</span> l2.ave<span class="op">-</span>l2paintol)
<span class="co"># Always be very cautious when overwriting your data object! </span>
<span class="co"># Novice users recommended to create a new name.</span>

<span class="kw">ggplot</span>(pain, <span class="kw">aes</span>(trial, diff)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_path</span>(<span class="kw">aes</span>(<span class="dt">group=</span>id), <span class="dt">alpha=</span>.<span class="dv">5</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">      </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="dv">0</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">lwd=</span><span class="dv">2</span>)<span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="longitudinal_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Few individuals have large variations in their pain tolerance across time, and it appears as if those that had higher than average at trial 2, were lower than average at trial 3, and vice versa.</p>
</div>
<div id="corrmat" class="section level3">
<h3><span class="header-section-number">1.2.2</span> Correlation of pain tolerance within person across time</h3>
<p>To calculate the correlation of <code>l2paintol</code> between trials, we need to reshape the data to wide format. In wide data, the measure of pain tolerance for each trial is itâ€™s own variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># First select only the variable we want to transform wide</span>
pain.<span class="fl">2.</span>wide &lt;-<span class="st"> </span>pain <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(id, trial, l2paintol)
<span class="co"># Use the reshape() function to transform - this comes with baseR</span>
pw &lt;-<span class="st"> </span><span class="kw">reshape</span>(pain.<span class="fl">2.</span>wide, <span class="dt">idvar=</span><span class="st">&quot;id&quot;</span>, <span class="dt">timevar=</span><span class="st">&quot;trial&quot;</span>, <span class="dt">direction=</span><span class="st">&quot;wide&quot;</span>)
<span class="co"># then calculate and visualize the correlation of pain tolerance across time points. </span>
corrplot<span class="op">::</span><span class="kw">corrplot.mixed</span>(<span class="kw">cor</span>(pw[,<span class="op">-</span><span class="dv">1</span>], <span class="dt">use =</span> <span class="st">&#39;pairwise.complete.obs&#39;</span>))</code></pre></div>
<p><img src="longitudinal_files/figure-html/unnamed-chunk-8-1.png" width="480" style="display: block; margin: auto;" /></p>
<p>There is a fairly high correlation of pain tolerance between trials.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="pediatric-pain-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="analyze-pain-tolerance-across-coping-style.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
